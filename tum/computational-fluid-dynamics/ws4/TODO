Things to check:
- cheeck how one can optimize computation of density and velocity